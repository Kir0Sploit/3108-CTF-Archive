#if 0
        shc Version 4.0.3, Generic Shell Script Compiler
        GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

        shc -f login-as-mahsuri.sh 
#endif

static  char data [] = 
#define      xecc_z     15
#define      xecc       ((&data[3]))
        "\013\057\037\173\065\204\351\066\233\302\112\244\042\116\317\204"
        "\215\364"
#define      text_z     5854
#define      text       ((&data[551]))
        "\363\210\011\311\327\232\071\154\272\241\323\076\060\044\166\246"
        "\231\004\210\327\031\275\075\004\334\110\063\374\042\221\140\025"
        "\031\152\336\361\004\030\136\277\271\062\375\352\127\164\220\360"
        "\170\031\310\221\326\005\225\263\116\311\260\160\132\020\206\163"
        "\172\145\145\177\175\303\076\066\365\074\040\114\260\261\075\050"
        "\313\005\272\242\013\117\125\131\031\005\311\163\026\120\347\220"
        "\265\114\017\062\020\116\151\005\212\212\122\072\073\220\143\007"
        "\225\035\251\240\155\376\372\206\004\303\372\032\024\341\253\311"
        "\055\272\373\075\010\144\103\223\356\226\316\052\046\061\061\273"
        "\117\333\134\275\332\126\103\336\032\075\371\056\037\244\370\114"
        "\137\363\212\150\130\316\373\106\144\311\161\212\373\243\106\113"
        "\176\243\010\130\372\114\067\025\211\060\104\251\325\074\366\065"
        "\057\200\235\210\116\231\316\263\143\077\076\137\342\204\252\141"
        "\050\262\271\042\376\360\067\210\041\174\061\366\270\047\053\350"
        "\250\311\160\367\143\077\252\307\177\351\046\142\155\321\303\225"
        "\203\174\270\202\155\360\013\216\154\075\205\044\145\260\015\015"
        "\172\176\005\335\275\260\245\074\231\313\236\007\234\142\235\040"
        "\336\125\242\114\105\256\332\262\353\137\327\120\020\344\136\213"
        "\142\143\151\040\023\016\134\255\331\373\264\166\135\121\227\074"
        "\247\072\210\355\350\142\237\323\302\166\043\322\132\201\135\275"
        "\345\306\335\371\325\072\246\257\065\132\045\222\254\274\316\123"
        "\366\127\100\337\272\337\262\174\126\326\117\260\130\255\156\075"
        "\164\114\066\111\206\334\370\274\067\036\116\343\333\035\067\322"
        "\165\167\261\057\127\143\253\255\072\373\136\222\250\315\320\034"
        "\031\007\146\240\343\137\134\033\175\253\377\130\310\066\052\076"
        "\256\333\155\006\077\030\263\171\023\022\014\274\337\334\331\371"
        "\343\077\231\307\237\365\343\034\240\342\165\151\031\240\247\307"
        "\173\024\315\273\055\201\065\101\224\101\375\163\036\327\154\001"
        "\026\005\311\265\372\254\322\233\217\107\004\250\347\253\160\143"
        "\300\076\037\355\300\124\056\124\226\054\307\265\003\064\267\032"
        "\072\200\320\065\055\242\320\274\352\325\145\322\200\325\066\100"
        "\024\125\056\324\252\135\050\101\211\360\366\214\044\255\247\137"
        "\056\167\224\133\031\145\030\004\072\175\326\273\123\014\374\147"
        "\142\052\073\014\207\020\365\022\037\123\122\230\376\142\041\060"
        "\274\152\067\040\375\313\341\201\066\341\374\070\351\025\323\356"
        "\301\003\176\363\077\263\222\224\262\224\213\120\036\004\310\227"
        "\230\332\275\051\125\312\221\373\230\155\224\345\166\213\102\022"
        "\300\272\001\343\172\211\353\041\043\064\217\110\070\361\240\357"
        "\352\104\360\022\010\262\022\163\177\354\126\364\065\025\067\264"
        "\206\366\114\177\276\111\053\324\277\343\112\026\062\277\320\252"
        "\376\342\076\224\254\242\160\043\135\205\251\315\156\050\126\160"
        "\177\364\251\337\322\271\216\370\171\215\074\253\130\153\364\316"
        "\124\320\221\066\100\125\326\041\041\206\234\177\227\162\034\353"
        "\255\342\062\172\303\303\251\215\035\141\330\054\220\006\131\077"
        "\373\333\232\055\242\170\025\244\132\236\144\122\350\322\117\105"
        "\247\155\111\130\103\301\074\226\017\125\036\260\045\013\202\313"
        "\037\221\022\115\362\160\165\237\312\177\125\060\130\042\310\062"
        "\041\221\117\342\251\377\017\154\142\062\133\075\166\007\070\121"
        "\053\234\005\346\242\253\050\143\052\025\222\200\212\115\201\141"
        "\355\320\334\224\130\011\100\173\177\165\342\115\220\224\243\020"
        "\113\236\325\234\355\346\343\371\071\376\216\024\311\277\055\230"
        "\202\272\043\242\115\340\001\233\122\354\274\207\055\051\374\273"
        "\333\175\266\156\237\162\120\122\052\230\343\264\342\134\267\055"
        "\317\371\310\354\217\143\317\237\267\331\000\206\315\341\222\173"
        "\173\062\304\141\152\020\362\116\240\232\211\021\262\034\330\174"
        "\137\014\047\140\062\034\334\026\276\357\041\305\276\126\261\340"
        "\160\274\142\161\203\353\037\211\346\051\016\364\217\317\046\267"
        "\144\203\121\052\264\127\047\316\316\224\253\014\210\015\260\112"
        "\225\017\210\335\023\214\026\370\361\177\372\274\224\100\007\243"
        "\011\103\105\115\146\245\357\303\044\363\052\362\101\362\170\116"
        "\366\174\177\032\362\166\320\355\062\376\210\015\003\257\245\165"
        "\266\244\006\012\306\361\244\052\077\366\162\164\033\277\276\044"
        "\272\230\241\141\213\017\256\157\146\140\352\227\225\056\322\174"
        "\072\074\277\302\217\125\100\055\140\264\227\001\231\341\235\351"
        "\025\071\244\267\066\056\315\061\006\333\240\201\207\306\325\131"
        "\057\230\322\240\055\237\157\344\340\340\354\151\375\151\255\200"
        "\007\326\222\177\227\207\212\335\164\334\275\272\200\367\036\276"
        "\361\111\260\264\005\063\006\121\264\107\330\026\300\303\036\141"
        "\302\070\067\126\045\237\223\102\054\376\227\334\162\135\063\055"
        "\154\335\211\202\302\304\072\141\137\210\061\014\005\016\221\100"
        "\143\256\224\230\167\113\036\163\143\136\105\173\201\164\203\356"
        "\112\151\312\256\347\236\021\335\035\072\116\357\326\210\374\307"
        "\075\275\222\003\047\157\270\015\124\316\341\332\125\166\231\141"
        "\327\370\043\100\322\274\352\300\131\033\337\102\017\136\013\037"
        "\030\175\165\270\333\316\374\241\345\227\046\303\051\231\220\144"
        "\206\063\034\301\154\033\133\311\300\375\135\254\245\203\027\377"
        "\347\261\011\067\135\170\145\001\203\124\270\160\361\073\305\342"
        "\150\362\243\063\211\276\375\144\062\302\131\372\127\104\101\030"
        "\351\037\035\270\374\355\153\374\343\177\034\304\005\265\014\014"
        "\366\350\227\007\136\326\015\235\117\244\074\025\337\162\200\025"
        "\354\045\255\054\104\172\345\013\160\030\221\002\324\232\277\336"
        "\272\331\122\332\343\272\377\102\061\264\360\234\201\010\365\164"
        "\172\310\204\267\232\356\170\270\241\116\270\071\277\040\070\360"
        "\136\072\271\173\173\064\072\050\374\310\373\064\210\116\167\160"
        "\175\364\347\041\156\270\331\073\075\060\076\312\152\035\347\102"
        "\025\272\053\032\134\004\372\256\300\327\077\271\163\057\154\163"
        "\126\105\341\371\066\306\366\341\370\265\051\132\316\366\016\327"
        "\261\340\173\310\057\040\276\121\031\137\057\242\320\332\376\331"
        "\150\255\136\252\324\303\007\027\017\102\275\040\260\035\263\314"
        "\221\066\207\324\012\247\312\351\253\030\000\246\126\143\167\040"
        "\001\156\356\145\014\330\362\206\076\364\302\323\333\306\167\323"
        "\136\370\351\334\343\274\115\075\166\375\015\174\307\036\053\353"
        "\213\120\104\074\004\054\077\170\035\265\246\231\036\273\150\234"
        "\011\070\212\002\042\341\022\315\366\220\337\312\357\017\064\356"
        "\064\130\302\261\117\366\220\153\223\045\074\320\353\154\140\203"
        "\264\171\016\205\144\143\332\365\300\005\022\223\310\067\362\226"
        "\066\310\076\267\123\054\250\124\323\124\256\235\324\317\371\053"
        "\054\015\112\254\337\043\174\334\211\175\026\253\170\022\337\273"
        "\371\232\004\042\161\040\323\032\251\021\015\021\302\364\342\250"
        "\322\320\336\332\300\345\260\105\052\221\165\325\043\275\261\311"
        "\166\217\253\177\061\173\046\340\200\222\063\230\361\124\330\360"
        "\242\107\141\163\117\130\073\373\345\221\011\133\201\217\155\261"
        "\173\161\350\337\014\050\136\352\321\036\177\172\043\174\324\113"
        "\102\061\134\351\366\244\217\200\240\341\136\321\114\226\067\251"
        "\021\332\223\140\037\113\200\203\335\123\133\207\154\343\376\140"
        "\231\003\234\172\020\347\016\077\163\377\041\321\006\112\221\077"
        "\274\323\214\230\023\017\225\275\215\162\353\267\133\363\231\376"
        "\356\056\360\233\152\373\232\173\030\126\053\015\013\170\122\243"
        "\340\026\313\203\041\145\255\204\075\011\101\040\074\234\224\272"
        "\013\220\233\061\007\300\241\063\052\332\311\003\276\110\213\004"
        "\226\165\004\061\150\044\075\163\217\072\350\026\015\066\012\131"
        "\065\115\263\141\237\340\201\251\261\065\073\041\075\165\176\306"
        "\327\305\066\223\101\235\105\147\230\107\113\066\224\366\252\101"
        "\037\334\041\246\177\353\006\027\055\306\354\327\162\140\055\215"
        "\351\224\321\220\200\350\061\246\157\155\354\263\312\040\365\316"
        "\025\057\342\073\235\177\031\326\213\303\251\055\202\177\153\214"
        "\237\220\355\145\046\051\002\263\071\340\373\117\047\137\076\226"
        "\221\013\014\212\101\375\003\310\366\144\362\273\144\074\045\141"
        "\332\274\076\032\125\234\076\163\151\227\024\370\227\005\362\251"
        "\137\320\340\107\045\353\201\203\341\121\070\276\077\316\312\207"
        "\033\321\012\217\243\341\052\303\201\323\346\331\257\335\370\335"
        "\376\045\223\110\226\210\214\067\350\122\076\055\241\116\070\015"
        "\100\002\252\030\151\220\034\215\370\301\154\043\274\050\016\116"
        "\272\243\120\130\331\204\363\045\365\040\217\141\066\124\225\137"
        "\372\371\006\325\333\304\144\372\244\114\244\212\370\353\027\111"
        "\225\107\335\160\262\105\166\035\100\064\135\130\216\076\221\145"
        "\076\003\160\323\374\351\034\006\232\213\173\002\262\246\057\372"
        "\140\223\343\354\232\146\252\135\133\217\170\272\263\343\137\176"
        "\037\343\051\207\177\210\276\024\201\023\332\221\223\015\216\213"
        "\027\055\200\206\126\071\035\152\113\211\244\367\257\225\145\156"
        "\310\035\075\137\152\121\134\307\067\133\043\040\142\227\101\144"
        "\304\315\370\027\062\264\251\376\331\262\223\051\217\076\341\111"
        "\211\111\176\072\233\146\021\335\140\127\146\120\064\306\337\161"
        "\124\037\333\014\035\111\210\266\126\235\174\021\205\042\314\303"
        "\267\314\323\342\124\053\243\143\332\316\347\124\036\245\253\320"
        "\105\166\130\267\357\144\037\350\122\060\234\247\162\065\203\170"
        "\312\355\153\267\212\112\102\047\323\047\136\205\263\262\277\025"
        "\363\357\003\220\014\053\175\027\307\013\153\370\005\032\061\375"
        "\127\010\275\123\237\276\373\152\016\135\036\236\030\322\204\102"
        "\315\167\372\350\062\377\122\000\104\053\217\121\031\234\003\273"
        "\236\277\212\251\144\002\242\334\003\166\047\033\262\152\040\372"
        "\303\151\102\140\153\351\133\104\351\320\267\307\350\343\216\144"
        "\103\061\267\077\342\023\215\032\101\314\132\172\350\061\340\030"
        "\047\054\345\153\026\017\174\012\060\322\115\237\030\171\154\273"
        "\127\245\066\002\015\057\153\001\164\220\062\315\144\236\225\272"
        "\273\107\367\273\214\270\323\151\304\214\364\332\300\362\276\360"
        "\174\376\127\342\344\341\320\125\174\115\370\072\150\243\353\363"
        "\023\002\147\375\132\050\143\034\020\145\071\373\053\105\205\151"
        "\266\025\250\056\252\220\373\014\115\103\312\175\173\227\112\056"
        "\063\350\113\146\012\000\366\135\137\107\315\044\054\124\106\206"
        "\125\170\250\250\301\116\375\313\341\156\052\271\155\326\222\243"
        "\053\070\235\151\372\201\262\077\034\304\044\037\214\170\232\347"
        "\126\175\312\061\062\372\132\265\366\117\120\140\031\265\062\001"
        "\336\371\067\041\056\125\217\222\254\344\306\234\311\324\122\062"
        "\306\370\133\107\132\201\260\302\144\124\342\352\232\237\064\127"
        "\072\131\374\022\320\021\015\370\164\146\355\323\117\262\205\303"
        "\261\367\212\306\014\043\027\326\126\201\352\233\005\222\164\002"
        "\120\263\322\201\157\075\315\072\120\023\066\072\134\234\205\342"
        "\311\326\130\326\174\340\020\236\000\232\264\203\267\027\376\264"
        "\060\300\056\373\304\277\237\263\343\261\260\010\072\135\133\231"
        "\107\340\176\377\123\120\135\334\134\020\075\236\210\254\234\161"
        "\224\024\145\323\203\016\154\161\106\144\370\014\354\024\033\106"
        "\146\220\136\065\135\171\132\206\032\102\342\170\372\270\252\155"
        "\240\042\250\107\173\361\005\016\176\116\253\145\103\205\232\047"
        "\134\331\255\374\372\236\315\300\267\167\141\217\235\177\152\330"
        "\120\066\125\125\125\050\044\322\026\147\255\310\241\364\254\207"
        "\034\353\243\373\162\275\111\277\273\320\007\011\331\275\021\213"
        "\307\273\231\064\074\214\255\133\236\254\375\337\217\130\331\345"
        "\062\330\173\005\265\024\146\337\231\014\115\331\373\360\007\273"
        "\273\031\110\377\353\144\227\012\010\343\151\242\227\072\212\341"
        "\336\307\322\352\014\134\246\143\203\022\376\324\265\163\246\142"
        "\264\134\032\200\277\305\176\034\143\317\042\044\330\267\020\067"
        "\267\207\154\321\054\020\251\134\016\362\355\261\101\246\106\132"
        "\277\136\255\301\107\144\061\356\242\170\360\121\341\054\027\365"
        "\335\314\272\002\127\117\317\201\074\271\256\162\364\062\037\027"
        "\176\233\374\211\153\101\172\050\230\326\164\214\320\357\017\074"
        "\062\030\075\074\335\144\012\213\260\106\151\117\356\217\063\276"
        "\376\306\330\371\066\267\112\057\261\370\266\150\042\275\144\255"
        "\362\331\272\040\047\114\132\267\017\066\072\112\046\371\201\377"
        "\211\224\056\125\134\151\272\075\050\236\052\213\267\013\105\103"
        "\273\025\015\361\366\136\307\356\275\312\154\266\236\034\211\123"
        "\135\056\343\250\222\003\113\030\012\005\330\304\331\160\171\362"
        "\310\054\114\226\045\303\124\213\332\201\241\223\266\234\046\022"
        "\124\303\035\360\030\132\032\016\026\234\223\232\177\303\146\213"
        "\273\220\042\345\154\015\023\076\101\223\207\215\027\340\146\274"
        "\376\121\132\375\344\365\170\121\022\265\020\160\022\332\146\266"
        "\257\244\256\236\202\160\230\311\102\333\141\214\377\301\304\350"
        "\245\066\216\172\031\145\222\073\206\022\304\152\054\361\057\333"
        "\067\105\043\366\271\056\322\324\270\361\145\227\062\214\006\043"
        "\222\055\245\071\357\157\036\376\273\101\167\202\321\235\252\045"
        "\165\231\327\146\105\233\017\237\212\236\021\016\114\121\272\143"
        "\352\064\115\151\273\215\161\202\312\117\362\227\367\274\031\247"
        "\165\134\353\013\046\276\360\226\334\353\270\162\116\013\206\123"
        "\161\365\112\071\240\126\156\362\173\126\012\243\101\155\246\063"
        "\350\263\016\372\364\357\232\355\164\204\247\065\010\324\116\144"
        "\103\263\150\364\220\336\202\335\004\336\141\073\201\267\143\326"
        "\262\056\242\012\156\215\337\222\217\330\304\027\220\251\205\317"
        "\026\162\363\332\364\150\136\156\023\176\100\007\036\126\204\364"
        "\033\010\344\061\327\355\306\041\025\105\246\317\305\312\324\367"
        "\052\170\165\121\223\170\002\007\215\314\232\052\112\250\333\177"
        "\312\324\160\176\226\116\244\112\014\314\175\043\112\244\262\035"
        "\313\231\274\272\160\170\157\023\343\250\323\211\251\272\003\024"
        "\377\037\206\370\165\005\056\115\242\065\064\130\346\202\202\052"
        "\027\274\311\241\057\006\107\371\133\026\044\133\224\147\164\036"
        "\343\060\021\120\213\200\244\200\171\273\125\215\223\250\052\173"
        "\153\213\134\053\016\077\364\356\162\120\315\217\174\355\157\216"
        "\017\045\155\127\016\263\350\206\240\161\134\063\311\065\341\067"
        "\024\222\210\164\060\340\320\065\026\326\340\235\204\066\074\062"
        "\154\036\244\274\157\370\355\327\156\015\376\372\302\377\051\224"
        "\111\243\102\065\156\265\167\152\202\162\214\373\357\326\335\207"
        "\206\213\260\274\150\024\036\074\173\223\174\236\242\155\157\141"
        "\056\050\226\221\223\211\077\055\057\264\107\372\052\343\333\153"
        "\157\332\165\140\007\265\322\355\241\035\052\030\057\164\170\356"
        "\011\062\332\003\301\305\355\024\311\275\225\020\100\175\312\346"
        "\274\031\026\264\103\260\253\240\173\102\051\045\067\272\106\013"
        "\222\145\227\151\333\361\302\344\307\017\266\113\135\030\153\104"
        "\011\256\240\135\024\347\145\310\122\311\074\113\064\041\072\102"
        "\231\232\354\074\122\240\353\273\366\171\273\171\240\256\134\010"
        "\360\140\213\251\311\211\343\211\347\311\147\141\115\006\011\361"
        "\356\002\212\043\207\130\200\015\217\353\223\102\110\371\372\203"
        "\106\155\340\042\336\122\262\057\046\111\207\023\277\277\046\363"
        "\064\070\367\316\117\042\305\141\203\335\251\274\344\346\314\233"
        "\152\313\165\351\244\036\170\162\377\142\126\256\137\142\022\333"
        "\170\266\123\322\225\136\054\321\232\271\171\064\355\006\103\224"
        "\324\323\004\261\235\013\236\137\327\122\331\301\034\127\314\160"
        "\136\376\245\255\264\001\333\321\160\174\010\257\142\333\253\235"
        "\167\026\370\361\021\012\040\243\346\035\325\346\071\203\134\275"
        "\227\031\124\224\363\154\305\213\322\032\035\316\315\327\006\232"
        "\223\127\131\027\040\260\341\265\253\136\372\273\013\217\332\040"
        "\114\007\016\103\264\104\057\165\167\227\307\343\324\251\114\077"
        "\112\076\054\115\053\304\323\145\060\061\245\213\251\247\132\041"
        "\066\061\135\072\371\100\275\313\233\126\311\311\337\273\140\116"
        "\021\332\361\005\053\237\245\106\027\171\017\242\255\051\360\014"
        "\313\134\123\311\255\331\346\344\011\175\047\030\036\307\350\172"
        "\074\117\171\020\060\001\037\331\300\020\246\117\122\042\137\203"
        "\273\336\237\367\104\132\227\370\036\374\316\277\226\314\227\060"
        "\255\072\340\330\337\027\011\101\222\210\036\242\045\307\054\067"
        "\165\314\146\063\101\077\007\073\375\222\002\074\060\377\130\373"
        "\232\261\114\303\031\175\011\223\216\312\300\221\256\313\166\122"
        "\356\074\007\347\017\134\344\266\253\333\334\264\044\153\061\043"
        "\367\034\006\055\113\157\147\114\132\051\030\206\171\371\013\342"
        "\147\200\141\351\300\146\146\366\121\370\214\152\060\322\362\374"
        "\255\014\026\264\166\362\177\206\105\153\351\227\333\376\066\056"
        "\351\001\212\056\102\202\335\306\376\347\214\027\306\325\004\137"
        "\047\223\350\012\117\264\065\327\030\376\220\277\152\100\004\151"
        "\067\353\004\045\143\016\101\066\227\355\255\105\252\327\266\114"
        "\121\073\232\272\377\017\015\216\155\122\047\116\102\072\325\350"
        "\232\024\202\041\142\135\160\312\061\161\312\275\024\272\000\322"
        "\042\065\145\310\164\176\026\271\271\352\154\242\335\016\036\124"
        "\106\104\055\262\377\325\377\253\133\204\250\121\022\261\070\140"
        "\130\117\345\033\046\155\036\306\003\316\370\114\237\371\016\026"
        "\203\152\067\105\073\164\132\112\367\050\304\327\150\023\214\072"
        "\142\256\025\106\354\147\011\031\370\205\052\027\136\131\160\073"
        "\256\154\001\113\111\116\134\306\362\323\242\243\171\130\224\321"
        "\375\233\352\044\005\102\034\234\262\356\275\014\145\154\374\001"
        "\203\134\017\373\135\032\107\241\102\203\271\017\242\277\140\305"
        "\366\371\141\245\237\053\043\315\154\066\234\242\152\046\013\054"
        "\316\365\226\203\140\344\244\071\127\335\123\072\142\247\275\165"
        "\052\321\013\071\356\376\244\333\071\125\257\235\067\363\100\373"
        "\366\043\001\233\003\363\372\132\061\150\136\175\321\161\124\241"
        "\110\246\220\320\257\065\107\137\145\320\156\036\147\030\330\160"
        "\135\173\016\371\044\055\041\245\037\266\174\121\260\266\325\061"
        "\112\104\316\157\254\173\363\141\021\057\263\237\234\223\323\317"
        "\007\160\322\050\316\247\176\127\064\306\124\112\132\201\141\177"
        "\046\246\220\213\024\361\104\066\241\015\032\036\372\057\066\363"
        "\266\226\115\005\217\130\126\127\063\311\015\235\032\153\346\026"
        "\011\326\321\177\131\024\260\214\304\020\332\025\171\253\050\344"
        "\044\167\340\363\255\116\133\340\207\044\265\077\041\055\144\257"
        "\040\337\100\233\020\302\031\241\372\326\005\321\126\347\226\322"
        "\206\235\102\003\033\140\237\241\152\255\360\331\234\373\343\041"
        "\326\102\075\351\330\305\271\334\321\276\207\006\272\013\221\035"
        "\307\222\114\022\050\144\002\167\367\013\231\350\050\045\024\176"
        "\302\351\241\075\335\057\303\055\174\141\110\143\254\057\172\374"
        "\247\000\325\016\172\162\246\307\026\305\237\357\316\313\117\051"
        "\023\207\227\124\254\247\263\106\317\264\035\224\017\276\314\276"
        "\350\374\260\376\224\164\264\145\124\340\323\054\034\146\323\126"
        "\231\123\024\334\216\337\317\330\200\046\344\377\344\134\127\365"
        "\065\136\270\357\070\222\111\032\063\153\167\065\172\267\364\037"
        "\043\230\230\344\306\305\046\275\045\135\345\030\157\223\301\044"
        "\247\361\011\110\337\363\373\376\257\076\353\367\316\120\262\062"
        "\110\266\232\161\053\103\074\262\041\235\100\312\375\133\360\353"
        "\273\131\354\247\175\034\155\206\224\023\055\164\002\377\003\315"
        "\250\233\007\257\052\277\156\302\160\043\312\210\150\120\123\023"
        "\257\256\164\351\376\002\105\376\213\321\043\352\250\052\156\023"
        "\352\004\262\030\337\260\313\337\100\045\174\266\210\011\324\176"
        "\372\362\162\045\175\317\266\121\261\273\237\332\066\320\167\346"
        "\266\363\145\207\252\354\257\223\067\374\132\071\254\362\277\031"
        "\023\335\230\327\274\350\037\141\061\162\376\123\115\066\136\136"
        "\153\376\103\111\314\276\231\167\304\120\035\216\024\345\053\262"
        "\242\336\034\301\254\147\264\326\142\151\007\272\277\142\335\220"
        "\344\047\065\261\307\343\235\260\336\376\360\036\043\204\342\142"
        "\231\100\233\200\364\341\210\177\035\023\231\135\174\315\104\154"
        "\216\375\324\331\050\301\272\217\114\150\367\252\256\252\220\024"
        "\126\111\341\266\004\130\063\253\330\007\363\164\053\363\351\014"
        "\061\040\126\015\264\242\071\022\325\321\267\331\313\012\101\214"
        "\022\123\003\140\312\344\250\123\361\254\101\073\241\313\233\325"
        "\203\327\017\002\034\253\357\015\024\242\101\304\256\346\110\201"
        "\313\161\333\137\303\377\056\357\131\054\250\076\125\175\352\000"
        "\025\035\275\201\117\271\256\312\141\215\066\342\133\275\076\225"
        "\022\267\063\151\307\235\312\263\377\240\342\370\303\040\227\347"
        "\017\225\337\007\271\215\127\262\114\034\005\242\301\023\136\204"
        "\172\024\227\077\003\311\204\330\274\312\261\147\171\027\171\053"
        "\005\342\202\323\306\005\326\241\351\043\363\203\122\357\303\300"
        "\177\365\263\051\027\122\062\234\015\315\140\351\031\257\246\046"
        "\177\003\303\245\123\164\125\216\127\042\177\165\343\214\246\312"
        "\060\023\227\234\177\245\132\105\301\215\346\220\152\151\035\036"
        "\162\055\256\066\137\237\356\265\366\327\355\034\125\215\174\232"
        "\225\123\250\106\043\360\207\255\052\362\143\011\000\113\123\067"
        "\126\217\332\377\246\103\236\305\174\005\117\221\045\332\117\063"
        "\156\364\363\106\163\334\242\306\257\043\153\157\136\227\226\117"
        "\164\106\373\044\133\325\213\370\075\071\004\023\001\045\336\200"
        "\363\315\321\145\324\100\072\312\375\170\377\145\342\245\141\056"
        "\154\053\374\227\016\063\167\314\352\126\276\032\327\356\263\316"
        "\026\052\367\326\105\207\127\222\000\371\350\117\022\017\022\203"
        "\341\203\341\031\121\207\242\122\230\125\172\342\100\320\357\111"
        "\174\303\242\030\332\153\041\232\155\316\326\023\067\203\260\110"
        "\223\153\005\205\264\247\255\031\255\046\120\111\134\052\121\212"
        "\071\252\234\076\166\357\135\176\307\146\115\216\122\223\011\333"
        "\207\102\306\271\211\125\174\256\121\014\123\042\214\355\101\337"
        "\172\031\322\107\047\237\224\342\171\213\257\247\017\376\212\246"
        "\200\301\254\275\003\074\147\317\157\133\107\007\346\107\173\214"
        "\056\302\360\371\133\331\302\052\001\271\141\364\244\065\222\133"
        "\370\337\320\150\116\331\345\311\347\125\027\237\337\106\263\364"
        "\105\045\327\241\010\226\360\004\167\165\335\070\327\260\177\222"
        "\165\362\075\267\254\024\253\063\065\206\133\131\105\144\041\376"
        "\250\046\113\020\056\361\157\136\054\072\176\140\304\160\301\037"
        "\157\237\364\140\255\210\145\064\166\227\237\301\327\376\170\037"
        "\175\021\061\031\245\256\063\373\225\304\324\220\027\171\202\030"
        "\006\257\102\060\354\124\374\120\012\216\030\257\344\330\366\061"
        "\042\256\020\257\100\076\213\177\206\351\065\133\150\202\071\032"
        "\147\045\127\315\322\012\360\267\302\073\007\016\026\166\150\230"
        "\330\374\261\164\330\326\246\163\035\364\035\015\327\002\104\201"
        "\040\166\000\350\156\246\133\237\015\210\360\224\307\121\156\227"
        "\227\140\354\052\317\102\244\204\054\211\052\206\256\210\010\326"
        "\217\251\032\302\071\044\215\024\310\217\211\332\241\042\244\367"
        "\140\154\270\272\340\367\330\026\036\213\232\172\340\235\164\241"
        "\063\320\146\163\065\276\356\352\076\001\317\156\307\311\315\116"
        "\146\241\251\131\266\115\205\016\336\024\230\360\050\004\125\217"
        "\121\165\040\200\375\363\316\114\033\210\262\270\066\110\356\003"
        "\106\020\062\305\275\211\165\252\245\306\172\323\211\213\101\327"
        "\335\327\157\341\356\071\316\213\113\350\266\310\264\052\276\304"
        "\251\256\203\003\272\047\171\303\203\000\300\257\234\047\307\234"
        "\131\004\354\365\025\131\176\351\316\131\044\002\107\140\067\114"
        "\367\000\320\250\125\100\124\032\230\374\273\163\277\113\202\240"
        "\042\273\142\067\063\066\156\374\073\317\020\141\224\156\116\153"
        "\356\075\213\112\120\155\151\222\202\073\127\361\203\350\146\036"
        "\073\142\147\015\202\200\351\261\313\165\325\312\014\041\053\226"
        "\211\327\320\257\336\010\001\345\173\177\261\176\074\145\064\020"
        "\251\147\274\307\233\335\347\226\254\377\165\177\200\356\110\241"
        "\245\150\137\006\025\353\045\175\140\074\316\276\263\367\145\224"
        "\066\240\274\372\053\053\060\300\046\072\154\122\251\000\006\223"
        "\244\155\355\172\220\106\270\055\100\265\053\366\226\136\340\057"
        "\076\054\011\162\110\304\122\273\326\256\273\214\366\166\113\123"
        "\035\131\051\263\056\277\012\072\103\101\072\020\006\011\213\200"
        "\125\316\366\014\003\373\307\132\302\255\360\063\276\157\267\156"
        "\375\135\247\114\031\110\235\005\215\254\046\264\223\066\027\376"
        "\074\011\323\065\007\161\362\044\201\222\213\354\033\370\305\127"
        "\201\310\321\253\315\177\270\261\037\017\322\023\023\205\010\222"
        "\305\112\363\116\353\165\365\371\037\243\004\043\172\173\121\243"
        "\162\245\114\367\024\130\337\377\126\121\351\156\056\010\320\155"
        "\202\266\015\075\241\324\010\204\367\373\022\064\011\130\202\034"
        "\336\242\125\234\303\124\004\331\125\354\351\070\022\226\120\237"
        "\266\350\112\171\342\203\246\067\043\314\123\143\202\051\254\330"
        "\361\114\207\140\165\131\377\263\141\053\355\361\023\034\233\030"
        "\243\000\102\163\043\337\300\166\217\311\167\270\256\106\161\001"
        "\066\161\360\153\244\156\373\102\252\247\155\174\165\245\350\260"
        "\142\104\031\251\014\112\340\337\316\312\300\246\303\047\120\333"
        "\352\067\201\042\161\370\077\361\213\376\006\174\200\206\207\141"
        "\346\275\363\173\342\124\021\203\250\136\023\134\272\270\306\052"
        "\026\153\223\162\257\112\132\240\143\255\373\014\262\026\104\371"
        "\207\052\313\046\166\264\210\320\256\242\023\101\120\332\072\306"
        "\214\074\353\104\251\047\177\150\342\346\166\344\067\212\230\206"
        "\036\243\252\127\341\076\202\023\014\014\206\305\357\045\122\235"
        "\331\336\144\007\360\321\037\004\264\347\362\047\375\033\153\166"
        "\120\333\001\351\201\355\223\117\264\061\332\227\367\156\162\263"
        "\233\024\017\272\270\304\341\075\037\230\160\201\121\206\325\177"
        "\002\102\247\236\001\035\204\276\007\017\340\262\025\017\315\034"
        "\344\252\147\172\024\370\121\267\337\073\304\031\323\121\270\316"
        "\226\204\145\034\201\113\112\376\102\135\252\203\234\241\322\373"
        "\144\232\200\032\367\125\054\242\012\132\343\340\165\073\200\030"
        "\167\173\147\232\330\004\173\357\155\230\200\032\276\275\026\217"
        "\260\236\146\343\321\312\100\200\176\371\041\031\022\371\321\172"
        "\255\035\273\341\227\020\247\064\300\040\115\335\166\320\206\125"
        "\100\114\303\252\231\040\076\153\155\253\066\250\274\150\025\043"
        "\313\231\007\351\376\353\227\206\302\047\215\015\063\014\033\025"
        "\051\202\205\306\216\122\231\076\203\161\254\012\133\237\033\100"
        "\106\057\347\235\177\221\256\140\102\052\030\061\362\357\312\244"
        "\100\335\020\152\213\371\262\046\213\150\126\207\113\046\034\041"
        "\060\345\104\324\214\024\255\143\254\235\337\324\215\353\070\354"
        "\060\055\115\177\327\165\374\145\370\123\122\035\014\051\010\113"
        "\125\357\030\020\251\006\144\007\367\251\170\050\022\203\302\333"
        "\100\010\172\032\367\355\102\327\237\067\365\043\026\077\001\023"
        "\365\257\176\032\365\375\222\154\364\103\267\376\060\066\100\076"
        "\147\354\134\341\312\225\052\120\167\240\221\015\207\273\016\141"
        "\324\377\035\163\050\064\163\202\246\134\037\331\106\246\152\057"
        "\373\260\344\034\270\037\341\215\035\342\160\374\134\000\227\360"
        "\215\120\333\132\277\010\207\365\334\054\014\372\262\245\342\257"
        "\336\171\021\024\243\320\102\213\165\153\227\061\060\107\361\051"
        "\232\336\275\076\345\171\342\322\327\314\321\156\206\004\144\263"
        "\043\024\034\143\116\020\124\104\235\171\362\104\330\040\273\155"
        "\173\325\322\223\332\015\021\260\310\144\275\305\313\040\357\007"
        "\055\167\152\173\210\277\277\046\070\261\152\020\321\046\176\115"
        "\374\121\341\326\136\362\207\047\126\105\355\041\145\335\050\222"
        "\124\223\015\334\123\315\002\213\177\155\234\121\224\032\236\221"
        "\154\177\147\313\161\357\362\310\065\340\352\232\275\022\055\021"
        "\246\072\356\371\010\361\205\210\136\041\331\362\074\170\204\250"
        "\370\353\163\152\333\146\062\020\106\034\253\003\057\330\025\325"
        "\023\003\317\034\364\124\244\123\166\175\106\262\366\312\132\356"
        "\266\315\130\221\063\212\242\172\246\116\175\326\046\222\254\072"
        "\226\173\126\213\320\372\336\106\170\044\370\156\356\123\134\245"
        "\040\264\066\124\077\331\316\346\047\114\274\116\337\151\210\165"
        "\344\337\000\265\331\337\373\122\003\364\300\362\107\035\227\150"
        "\322\316\274\021\250\212\370\317\327\265\036\266\036\246\053\003"
        "\206\054\270\137\013\264\262\017\250\162\001\360\220\231\130\142"
        "\150\025\164\020\240\155\340\167\042\376\055\100\245\131\104\053"
        "\206\374\213\221\261\075\241\131\260\243\112\100\074\243\243\244"
        "\270\027\265\130\205\225\317\247\224\375\350\071\127\054\145\335"
        "\051\361\157\332\056\020\064\336\263\176\037\360\041\302\225\332"
        "\332\112\062\137\340\002\007\164\000\357\256\127\034\024\064\105"
        "\005\243\040\063\263\124\022\147\323\062\127\365\365\354\317\317"
        "\067\001\057\027\004\067\213\004\047\072\133\103\116\217\211\123"
        "\063\251\207\347\376\232\116\321\314\246\306\301\223\225\221\312"
        "\227\301\341\233\370\155\240\037\247\373\143\366\213\354\111\276"
        "\226\320\246\224\152\365\146\067\233\055\371\056\302\212\371\132"
        "\114\333\366\104\110\226\144\360\221\307\346\035\263\060\334\112"
        "\001\202\336\154\167\105\243\023\162\234\102\065\047\073\217\163"
        "\026\205\270\137\033\034\117\255\343\066\313\227\146\247\341\147"
        "\051\300\324\241\005\167\265\167\024\367\255\074\062\074\257\111"
        "\302\147\250\336\204\370\214\147\056\127\376\225\376\337\374\050"
        "\237\320\312\245\110\177\035\135\166\312\231\251\006\111\363\311"
        "\261\233\247\065\223\063\234\302\212\233\127\211\172\124\262\032"
        "\045\174\300\155\373\335\313\162\247\144\034\256\255\017\170\137"
        "\253\037\224\077\122\060\001\335\314\130\147\106\255\031\141\322"
        "\225\041\100\221\377\013\004\247\160\040\126\036\057\316\175\333"
        "\355\021\032\100\102\033\036\016\164\205\125\041"
#define      msg2_z     19
#define      msg2       ((&data[6977]))
        "\064\330\063\100\025\250\070\151\035\332\067\326\244\337\377\277"
        "\252\034\002\233\063\142\305\330\077\312"
#define      tst1_z     22
#define      tst1       ((&data[7004]))
        "\325\315\032\243\215\343\041\015\301\011\032\371\245\143\236\244"
        "\145\154\251\026\167\014\154\361\002\065\113\365\221\134\017"
#define      tst2_z     19
#define      tst2       ((&data[7034]))
        "\357\255\237\060\147\323\372\177\370\231\333\307\006\177\335\066"
        "\027\113\041\114\235\267"
#define      lsto_z     1
#define      lsto       ((&data[7053]))
        "\276"
#define      msg1_z     65
#define      msg1       ((&data[7066]))
        "\107\222\350\015\152\050\327\351\327\302\277\245\117\320\041\320"
        "\345\050\324\114\257\260\350\347\043\160\047\363\072\244\065\002"
        "\040\215\165\323\265\315\030\010\154\122\357\046\335\145\173\250"
        "\042\357\203\237\320\257\302\157\173\115\101\271\122\161\270\073"
        "\316\240\047\111\025\355\315\071\125\254\172\111\173\335\142\360"
        "\322\363\115\342\305\354\016\264\231"
#define      rlax_z     1
#define      rlax       ((&data[7143]))
        "\241"
#define      chk1_z     22
#define      chk1       ((&data[7145]))
        "\044\124\201\315\225\344\347\302\213\065\114\243\364\372\354\265"
        "\033\173\124\046\241\177\234\204"
#define      chk2_z     19
#define      chk2       ((&data[7168]))
        "\005\010\255\120\312\152\064\103\374\352\125\100\175\274\213\000"
        "\273\305\104\121\065"
#define      opts_z     1
#define      opts       ((&data[7189]))
        "\214"
#define      date_z     1
#define      date       ((&data[7190]))
        "\336"
#define      pswd_z     256
#define      pswd       ((&data[7214]))
        "\334\121\360\277\027\334\315\313\166\173\365\021\353\063\147\017"
        "\267\116\034\112\240\122\264\225\102\235\260\337\302\057\110\255"
        "\153\045\264\054\145\024\236\372\357\047\137\106\136\360\111\341"
        "\034\111\342\044\243\012\272\345\250\152\305\153\232\015\030\005"
        "\063\315\062\230\341\320\223\321\367\362\027\125\342\140\066\376"
        "\252\031\043\115\043\336\063\314\111\370\067\343\006\120\351\072"
        "\035\033\323\377\354\146\320\343\130\347\071\073\110\160\072\362"
        "\211\136\077\255\074\162\171\205\153\261\151\162\001\123\254\037"
        "\157\177\036\133\345\357\076\076\326\170\171\037\350\263\021\161"
        "\021\120\036\116\303\230\323\056\111\075\240\113\220\115\152\377"
        "\314\210\133\261\167\232\357\116\022\151\155\372\035\177\153\056"
        "\320\212\175\223\042\120\302\154\216\143\267\037\260\041\037\174"
        "\252\172\056\042\024\036\160\046\207\336\041\244\135\214\323\055"
        "\027\121\301\071\241\203\246\060\347\135\117\230\176\156\025\050"
        "\350\103\113\375\142\273\044\352\232\105\217\370\322\143\046\351"
        "\264\347\043\126\153\311\206\122\047\326\352\245\104\000\316\055"
        "\103\031\053\246\325\117\220\160\224\040\150\147\203\216\120\067"
        "\166\164\216\341\076\024\064\333\137\340\326\021\352\064\265\306"
        "\206\246\205\235\203\123\151\371\316\137\013\272\222\162\311\112"
        "\300\346\224\140\070\110\074\227\051\023\251\023\110\136\332\317"
#define      shll_z     10
#define      shll       ((&data[7512]))
        "\210\141\321\002\215\214\037\042\063\117\301\263"
#define      inlo_z     3
#define      inlo       ((&data[7523]))
        "\123\017\172"/* End of data[] */;
#define      hide_z     4096
#define SETUID 0        /* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC       0       /* Define as 1 to debug execvp calls */
#define TRACEABLE       1       /* Define as 1 to enable ptrace the executable */
#define HARDENING       0       /* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON       0       /* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
        indx = jndx = kndx = 0;
        do {
                stte[indx] = indx;
        } while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
        unsigned char tmp, * ptr = (unsigned char *)str;
        while (len > 0) {
                do {
                        tmp = stte[indx];
                        kndx += tmp;
                        kndx += ptr[(int)indx % len];
                        stte[indx] = stte[kndx];
                        stte[kndx] = tmp;
                } while (++indx);
                ptr += 256;
                len -= 256;
        }
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
        unsigned char tmp, * ptr = (unsigned char *)str;
        while (len > 0) {
                indx++;
                tmp = stte[indx];
                jndx += tmp;
                stte[indx] = stte[jndx];
                stte[jndx] = tmp;
                tmp += stte[indx];
                *ptr ^= stte[tmp];
                ptr++;
                len--;
        }
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++) fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
        char * cc, * cflags, * ldflags;
    char cmd[4096];

        cc = getenv("CC");
        if (!cc) cc = "cc";

        sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
        if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
        remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

        unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
        struct stat statf[1];
        struct stat control[1];

        if (stat(file, statf) < 0)
                return -1;

        /* Turn on stable fields */
        memset(control, 0, sizeof(control));
        control->st_ino = statf->st_ino;
        control->st_dev = statf->st_dev;
        control->st_rdev = statf->st_rdev;
        control->st_uid = statf->st_uid;
        control->st_gid = statf->st_gid;
        control->st_size = statf->st_size;
        control->st_mtime = statf->st_mtime;
        control->st_ctime = statf->st_ctime;
        key(control, sizeof(control));
        return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
        int i;
        fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
        fprintf(stderr, "argc=%d\n", argc);
        if (!argv) {
                fprintf(stderr, "argv=<null>\n");
        } else { 
                for (i = 0; i <= argc ; i++)
                        fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
        }
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
        for (; argv && *argv && *argv != arg; argv++);
        for (; argv && *argv; argv++)
                *argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
        char buff[512];
        unsigned long mask, m;
        int l, a, c;
        char * string;
        extern char ** environ;

        mask = (unsigned long)getpid();
        stte_0();
         key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
         key(&data, sizeof(data));
         key(&mask, sizeof(mask));
        arc4(&mask, sizeof(mask));
        sprintf(buff, "x%lx", mask);
        string = getenv(buff);
#if DEBUGEXEC
        fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
        l = strlen(buff);
        if (!string) {
                /* 1st */
                sprintf(&buff[l], "=%lu %d", mask, argc);
                putenv(strdup(buff));
                return 0;
        }
        c = sscanf(string, "%lu %d%c", &m, &a, buff);
        if (c == 2 && m == mask) {
                /* 3rd */
                rmarg(environ, &string[-l - 1]);
                return 1 + (argc - a);
        }
        return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
        char procfile[BUFSIZ];
        sprintf(procfile, "/proc/%d/cmdline", pid);
        FILE* f = fopen(procfile, "r");
        if (f) {
                size_t size;
                size = fread(name, sizeof (char), sizeof (procfile), f);
                if (size > 0) {
                        if ('\n' == name[size - 1])
                                name[size - 1] = '\0';
                }
                fclose(f);
        }
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC     PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
        char proc[80];
        int pid, mine;

        switch(pid = fork()) {
        case  0:
                pid = getppid();
                /* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
                sprintf(proc, "/proc/%d/mem", (int)pid);
#else
                sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
                close(0);
                mine = !open(proc, O_RDWR|O_EXCL);
                if (!mine && errno != EBUSY)
                        mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
                if (mine) {
                        kill(pid, SIGCONT);
                } else {
                        perror(argv0);
                        kill(pid, SIGKILL);
                }
                _exit(mine);
        case -1:
                break;
        default:
                if (pid == waitpid(pid, 0, 0))
                        return;
        }
        perror(argv0);
        _exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
        char * scrpt;
        int ret, i, j;
        char ** varg;
        char * me = argv[0];
        if (me == NULL) { me = getenv("_"); }
        if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

        ret = chkenv(argc);
        stte_0();
         key(pswd, pswd_z);
        arc4(msg1, msg1_z);
        arc4(date, date_z);
        if (date[0] && (atoll(date)<time(NULL)))
                return msg1;
        arc4(shll, shll_z);
        arc4(inlo, inlo_z);
        arc4(xecc, xecc_z);
        arc4(lsto, lsto_z);
        arc4(tst1, tst1_z);
         key(tst1, tst1_z);
        arc4(chk1, chk1_z);
        if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
                return tst1;
        arc4(msg2, msg2_z);
        if (ret < 0)
                return msg2;
        varg = (char **)calloc(argc + 10, sizeof(char *));
        if (!varg)
                return 0;
        if (ret) {
                arc4(rlax, rlax_z);
                if (!rlax[0] && key_with_file(shll))
                        return shll;
                arc4(opts, opts_z);
#if HARDENING
            arc4_hardrun(text, text_z);
            exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
                arc4(text, text_z);
                arc4(tst2, tst2_z);
                 key(tst2, tst2_z);
                arc4(chk2, chk2_z);
                if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
                        return tst2;
                /* Prepend hide_z spaces to script text to hide it. */
                scrpt = malloc(hide_z + text_z);
                if (!scrpt)
                        return 0;
                memset(scrpt, (int) ' ', hide_z);
                memcpy(&scrpt[hide_z], text, text_z);
        } else {                        /* Reexecute */
                if (*xecc) {
                        scrpt = malloc(512);
                        if (!scrpt)
                                return 0;
                        sprintf(scrpt, xecc, me);
                } else {
                        scrpt = me;
                }
        }
        j = 0;
#if BUSYBOXON
        varg[j++] = "busybox";
        varg[j++] = "sh";
#else
        varg[j++] = argv[0];            /* My own name at execution */
#endif
        if (ret && *opts)
                varg[j++] = opts;       /* Options on 1st line of code */
        if (*inlo)
                varg[j++] = inlo;       /* Option introducing inline code */
        varg[j++] = scrpt;              /* The script itself */
        if (*lsto)
                varg[j++] = lsto;       /* Option meaning last option */
        i = (ret > 1) ? ret : 0;        /* Args numbering correction */
        while (i < argc)
                varg[j++] = argv[i++];  /* Main run-time arguments */
        varg[j] = 0;                    /* NULL terminated array */
#if DEBUGEXEC
        debugexec(shll, j, varg);
#endif
        execvp(shll, varg);
        return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
        debugexec("main", argc, argv);
#endif
#if HARDENING
        hardening();
#endif
#if !TRACEABLE
        untraceable(argv[0]);
#endif
        argv[1] = xsh(argc, argv);
        fprintf(stderr, "%s%s%s: %s\n", argv[0],
                errno ? ": " : "",
                errno ? strerror(errno) : "",
                argv[1] ? argv[1] : "<null>"
        );
        return 1;
}
